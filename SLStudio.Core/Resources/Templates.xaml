<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!--WindowIconTemplate-->
    <DataTemplate x:Key="WindowIconTemplate">
        <Grid Margin="6, 0, 3, 0" RenderOptions.BitmapScalingMode="HighQuality">
            <Rectangle Height="32" Width="32">
                <Rectangle.OpacityMask>
                    <ImageBrush ImageSource="{StaticResource AppIcon}" />
                </Rectangle.OpacityMask>

                <Rectangle.Style>
                    <Style TargetType="{x:Type Rectangle}">
                        <Setter Property="Fill" Value="{DynamicResource MahApps.Brushes.AccentBase}" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsKeyboardFocusWithin, RelativeSource={RelativeSource AncestorType=metro:MetroWindow}}" Value="False">
                                <Setter Property="Fill" Value="{DynamicResource MahApps.Brushes.Accent2}" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Rectangle.Style>
            </Rectangle>
        </Grid>
    </DataTemplate>
</ResourceDictionary>